# DAY 1

## 점심시간

12:15분

## 앤서블 
아래 작업은 "control"노드에서만 작업 수행.

```bash

## 기본 저장소에서 설치

dnf search ansible
> ansible
dnf install ansible -y
dnf search ansible-navigator

## 파이선 저장소에서 설치

dnf install python-pip
pip install ansible ansible-navigator

## 비공개 및 공개키 생성 및 배포

ssh-keygen -t rsa -N '' -f ~/.ssh/id_rsa
dnf install sshpass -y

ssh-copy-id root@10.10.10.250
ssh-copy-id root@10.10.10.1
ssh-copy-id root@10.10.10.2
ssh-copy-id root@10.10.10.3
ssh-copy-id root@10.10.10.4
```

## 설치 검증

"control"에서 다음과 같이 명령어 실행.

```bash

ansible all -i 10.10.10.250,10.10.10.1,10.10.10.2,10.10.10.3 -m ping

```

## 에디터 추가 설정

```bash
dnf search vim
dnf install vim-ale vim-ansible yamllint
vi ~/.vimrc
```

## 문법 테스트 및 확인

```bash
vim syntax1.yaml
```

```yaml
---
- name: first playbook
  hosts: all

  tasks:
    - name: first step module
      ping:
...
```

```bash
ansible-playbook -i10.10.10.1,10.10.10.2,10.10.10.3 syntax1.yaml
```

## 문법

```yaml
- name:
  hosts: all

  tasks:
    - name: 한글로는 작성하지 않음.
      shell: ls -l /tmp

```


# DAY 2

앤서블 애드훅부터 ~ 플레이북 만드는것.
- 조건문
- 파이썬에서 사용하는 Jinja2 템플릿 
- 서비스 구성(role)
- 특정 앤서블 모듈을 통해서 서비스 구성

```bash
ansible-doc -l
> posix


```

## 기본구성

앤서블 플레이북 생성 시, 일반적으로 작업 디렉터리를 생성. 

1. ansible.cfg
2. playbook
3. files
4. template files
5. roles directory

```bash
mkdir ansible
ansible-config init --disabled -t all > ~/ansible/ansible.cfg # touch ansible.cfg
-------------------
    \
     `---> /etc/ansible/ansible.cfg

vim ansible.cfg
> [defaults]
> inventory = /root/ansible/hosts
> # roles_path={{ ANSIBLE_HOME ~ "/roles:/usr/share/ansible/roles:/etc/ansible/roles" }}
> roles_path = roles:/usr/share/ansible/roles:/etc/ansible/roles
> remote_user = lab_user
>
> [privilege_escalation]
> # become_method = sudo 
> # become = true
> # become_user = root

```

### 연습문제

다음과 같이 앤서블 프로젝트 디렉터리를 생성 후, ansible설정을 적용한다. 앤서블 사용자 계정은 "anslab"를 사용한다.

1. 앤서블 사용자 디렉터리에 "ansible"작업 디렉터리를 구성 및 생성한다.
2. 설정 파일은 ansible에 생성한다.
3. 인벤토리 파일 이름은 hosts로 한다.
4. roles 경로 ansible/roles를 추가한다.
5. 외부에 접근 시 사용하는 계정은 remoteuser으로 설정한다.

__추가__

인벤토리 파일에는 다음과 같이 서버 정보가 입력이 되어야 한다.

```INI
node1.example.com node2.example.com node3.example.com
```


# DAY 3

# DAY 4